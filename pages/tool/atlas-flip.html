<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <base href="../../" />
    <meta name="viewport" content="width=device-width" />
    <title></title>

    <style type="text/css"><!--

    --></style>

    <script type="text/javascript" src="lib/include.js"></script>
    <script type="text/javascript"><!--

        "use strict";

        //--------------------------------------------------------------------------------------------------
        function go() {

            var atlas = Asset.take("slash");

            // 描画先の canvas を作成。
            var canvas = document.createElement("canvas");
            canvas.width = atlas.nums.x * atlas.width;
            canvas.height = atlas.nums.y * atlas.height;
            var context = canvas.getContext("2d");

            // コンテキストを横反転しておく。
            context.scale(-1, 1);

            // 一セルずつ描画していく。
            for(var y = 0 ; y < atlas.nums.y ; y++) {
                for(var x = 0 ; x < atlas.nums.x ; x++) {

                    var piece = atlas.piece(x, y);

                    var sphere = piece.clip.multi(-1, 1).normalize();

                    piece.drawTo(context, sphere);
                }
            }

            // 作成したキャンバスの内容を <img> に表示。
            document.getElementById("img").src = canvas.toDataURL();
        }

        //--------------------------------------------------------------------------------------------------
        function go2() {

        }

        //--------------------------------------------------------------------------------------------------
        document.addEventListener("DOMContentLoaded", ()=>{

            Asset.load("art/graph/slash.5&2.png");
            Asset.getCompletePromise().then(go);
        });

    --></script>

  </head>

  <body>

    <button onclick="go()">go</button><button onclick="go2()">go2</button><br />

    <p><img id="img" /></p>

  </body>
</html>

